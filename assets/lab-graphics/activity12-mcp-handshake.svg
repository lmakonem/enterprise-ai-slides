<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="400" viewBox="0 0 800 400">
  <defs>
    <linearGradient id="bgGradE5" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="400" fill="url(#bgGradE5)"/>
  
  <!-- Title -->
  <text x="400" y="35" fill="#3b82f6" font-family="Inter, sans-serif" font-size="18" font-weight="600" text-anchor="middle">MCP Protocol Handshake Sequence</text>
  
  <!-- Client Column -->
  <g transform="translate(150, 60)">
    <rect x="0" y="0" width="120" height="50" rx="8" fill="#1e293b" stroke="#3b82f6" stroke-width="2"/>
    <text x="60" y="30" fill="#3b82f6" font-family="Inter, sans-serif" font-size="12" font-weight="600" text-anchor="middle">MCP Client</text>
    <text x="60" y="45" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">(Host App)</text>
  </g>
  
  <!-- Server Column -->
  <g transform="translate(530, 60)">
    <rect x="0" y="0" width="120" height="50" rx="8" fill="#1e293b" stroke="#14b8a6" stroke-width="2"/>
    <text x="60" y="30" fill="#14b8a6" font-family="Inter, sans-serif" font-size="12" font-weight="600" text-anchor="middle">MCP Server</text>
    <text x="60" y="45" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">(Tool Provider)</text>
  </g>
  
  <!-- Vertical lifelines -->
  <line x1="210" y1="115" x2="210" y2="350" stroke="#3b82f6" stroke-width="2" stroke-dasharray="5,3"/>
  <line x1="590" y1="115" x2="590" y2="350" stroke="#14b8a6" stroke-width="2" stroke-dasharray="5,3"/>
  
  <!-- Message 1: initialize request -->
  <g transform="translate(210, 130)">
    <line x1="0" y1="0" x2="380" y2="0" stroke="#3b82f6" stroke-width="2"/>
    <polygon points="380,0 370,-5 370,5" fill="#3b82f6"/>
    <rect x="120" y="-25" width="140" height="45" rx="5" fill="#1e293b" stroke="#3b82f6" stroke-width="1"/>
    <text x="190" y="-8" fill="#3b82f6" font-family="Inter, sans-serif" font-size="10" font-weight="600" text-anchor="middle">initialize</text>
    <text x="190" y="8" fill="#94a3b8" font-family="monospace" font-size="8" text-anchor="middle">{ protocolVersion,</text>
    <text x="190" y="18" fill="#94a3b8" font-family="monospace" font-size="8" text-anchor="middle">capabilities, clientInfo }</text>
  </g>
  
  <!-- Message 2: initialize response -->
  <g transform="translate(210, 195)">
    <line x1="380" y1="0" x2="0" y2="0" stroke="#14b8a6" stroke-width="2"/>
    <polygon points="0,0 10,-5 10,5" fill="#14b8a6"/>
    <rect x="120" y="-25" width="140" height="45" rx="5" fill="#1e293b" stroke="#14b8a6" stroke-width="1"/>
    <text x="190" y="-8" fill="#14b8a6" font-family="Inter, sans-serif" font-size="10" font-weight="600" text-anchor="middle">initialize (response)</text>
    <text x="190" y="8" fill="#94a3b8" font-family="monospace" font-size="8" text-anchor="middle">{ protocolVersion,</text>
    <text x="190" y="18" fill="#94a3b8" font-family="monospace" font-size="8" text-anchor="middle">capabilities, serverInfo }</text>
  </g>
  
  <!-- Message 3: initialized notification -->
  <g transform="translate(210, 255)">
    <line x1="0" y1="0" x2="380" y2="0" stroke="#3b82f6" stroke-width="2"/>
    <polygon points="380,0 370,-5 370,5" fill="#3b82f6"/>
    <rect x="140" y="-20" width="100" height="35" rx="5" fill="#1e293b" stroke="#3b82f6" stroke-width="1"/>
    <text x="190" y="-3" fill="#3b82f6" font-family="Inter, sans-serif" font-size="10" font-weight="600" text-anchor="middle">initialized</text>
    <text x="190" y="10" fill="#94a3b8" font-family="monospace" font-size="8" text-anchor="middle">(notification)</text>
  </g>
  
  <!-- Ready State -->
  <g transform="translate(300, 300)">
    <rect x="0" y="0" width="200" height="40" rx="6" fill="#14532d" stroke="#22c55e" stroke-width="2"/>
    <text x="100" y="25" fill="#22c55e" font-family="Inter, sans-serif" font-size="12" font-weight="600" text-anchor="middle">âœ“ Connection Ready</text>
  </g>
  
  <!-- Step Labels -->
  <g transform="translate(30, 130)">
    <circle cx="15" cy="0" r="12" fill="#3b82f6" opacity="0.2"/>
    <text x="15" y="5" fill="#3b82f6" font-family="Inter, sans-serif" font-size="11" font-weight="600" text-anchor="middle">1</text>
    <text x="50" y="5" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9">Client initiates</text>
  </g>
  
  <g transform="translate(660, 195)">
    <circle cx="15" cy="0" r="12" fill="#14b8a6" opacity="0.2"/>
    <text x="15" y="5" fill="#14b8a6" font-family="Inter, sans-serif" font-size="11" font-weight="600" text-anchor="middle">2</text>
    <text x="50" y="5" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9">Server responds</text>
  </g>
  
  <g transform="translate(30, 255)">
    <circle cx="15" cy="0" r="12" fill="#3b82f6" opacity="0.2"/>
    <text x="15" y="5" fill="#3b82f6" font-family="Inter, sans-serif" font-size="11" font-weight="600" text-anchor="middle">3</text>
    <text x="50" y="5" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9">Client confirms</text>
  </g>
  
  <!-- Bottom Info -->
  <g transform="translate(100, 360)">
    <rect x="0" y="0" width="600" height="35" rx="6" fill="#1e293b" stroke="#334155" stroke-width="1"/>
    <text x="300" y="15" fill="#94a3b8" font-family="Inter, sans-serif" font-size="10" text-anchor="middle">Transport: stdio (local) | HTTP+SSE (remote) | WebSocket (real-time)</text>
    <text x="300" y="28" fill="#64748b" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">After handshake: tools/list, tools/call, resources/read, prompts/get</text>
  </g>
</svg>
