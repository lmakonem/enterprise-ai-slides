<?xml version="1.0" encoding="UTF-8"?>
<svg xmlns="http://www.w3.org/2000/svg" width="800" height="500" viewBox="0 0 800 500">
  <defs>
    <linearGradient id="bgGradE4" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#0f172a"/>
      <stop offset="100%" style="stop-color:#1e293b"/>
    </linearGradient>
  </defs>
  
  <!-- Background -->
  <rect width="800" height="500" fill="url(#bgGradE4)"/>
  
  <!-- Title -->
  <text x="400" y="35" fill="#3b82f6" font-family="Inter, sans-serif" font-size="18" font-weight="600" text-anchor="middle">LLM Application Threat Model (STRIDE)</text>
  
  <!-- Central LLM App -->
  <g transform="translate(310, 180)">
    <rect x="0" y="0" width="180" height="100" rx="12" fill="#1e293b" stroke="#3b82f6" stroke-width="3"/>
    <text x="90" y="35" fill="#3b82f6" font-family="Inter, sans-serif" font-size="14" font-weight="700" text-anchor="middle">LLM</text>
    <text x="90" y="55" fill="#3b82f6" font-family="Inter, sans-serif" font-size="14" font-weight="700" text-anchor="middle">Application</text>
    <text x="90" y="80" fill="#94a3b8" font-family="Inter, sans-serif" font-size="10" text-anchor="middle">RAG + Agent + API</text>
  </g>
  
  <!-- S - Spoofing -->
  <g transform="translate(30, 60)">
    <rect x="0" y="0" width="200" height="100" rx="8" fill="#1e293b" stroke="#ef4444" stroke-width="2"/>
    <circle cx="25" cy="25" r="18" fill="#ef4444" opacity="0.2"/>
    <text x="25" y="32" fill="#ef4444" font-family="Inter, sans-serif" font-size="16" font-weight="700" text-anchor="middle">S</text>
    <text x="115" y="28" fill="#ef4444" font-family="Inter, sans-serif" font-size="12" font-weight="600" text-anchor="middle">Spoofing</text>
    <line x1="10" y1="42" x2="190" y2="42" stroke="#ef4444" stroke-width="1" opacity="0.3"/>
    <text x="100" y="60" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Fake user identity</text>
    <text x="100" y="75" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Impersonate admin</text>
    <text x="100" y="90" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Forge API credentials</text>
  </g>
  <line x1="230" y1="110" x2="310" y2="200" stroke="#ef4444" stroke-width="1" stroke-dasharray="4,2"/>
  
  <!-- T - Tampering -->
  <g transform="translate(570, 60)">
    <rect x="0" y="0" width="200" height="100" rx="8" fill="#1e293b" stroke="#f59e0b" stroke-width="2"/>
    <circle cx="25" cy="25" r="18" fill="#f59e0b" opacity="0.2"/>
    <text x="25" y="32" fill="#f59e0b" font-family="Inter, sans-serif" font-size="16" font-weight="700" text-anchor="middle">T</text>
    <text x="115" y="28" fill="#f59e0b" font-family="Inter, sans-serif" font-size="12" font-weight="600" text-anchor="middle">Tampering</text>
    <line x1="10" y1="42" x2="190" y2="42" stroke="#f59e0b" stroke-width="1" opacity="0.3"/>
    <text x="100" y="60" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Poison training data</text>
    <text x="100" y="75" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Modify RAG documents</text>
    <text x="100" y="90" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Alter model weights</text>
  </g>
  <line x1="570" y1="110" x2="490" y2="200" stroke="#f59e0b" stroke-width="1" stroke-dasharray="4,2"/>
  
  <!-- R - Repudiation -->
  <g transform="translate(30, 190)">
    <rect x="0" y="0" width="200" height="100" rx="8" fill="#1e293b" stroke="#22c55e" stroke-width="2"/>
    <circle cx="25" cy="25" r="18" fill="#22c55e" opacity="0.2"/>
    <text x="25" y="32" fill="#22c55e" font-family="Inter, sans-serif" font-size="16" font-weight="700" text-anchor="middle">R</text>
    <text x="115" y="28" fill="#22c55e" font-family="Inter, sans-serif" font-size="12" font-weight="600" text-anchor="middle">Repudiation</text>
    <line x1="10" y1="42" x2="190" y2="42" stroke="#22c55e" stroke-width="1" opacity="0.3"/>
    <text x="100" y="60" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Deny sending prompt</text>
    <text x="100" y="75" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• No audit trail</text>
    <text x="100" y="90" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Untraceable actions</text>
  </g>
  <line x1="230" y1="240" x2="310" y2="230" stroke="#22c55e" stroke-width="1" stroke-dasharray="4,2"/>
  
  <!-- I - Information Disclosure -->
  <g transform="translate(570, 190)">
    <rect x="0" y="0" width="200" height="100" rx="8" fill="#1e293b" stroke="#3b82f6" stroke-width="2"/>
    <circle cx="25" cy="25" r="18" fill="#3b82f6" opacity="0.2"/>
    <text x="25" y="32" fill="#3b82f6" font-family="Inter, sans-serif" font-size="16" font-weight="700" text-anchor="middle">I</text>
    <text x="115" y="28" fill="#3b82f6" font-family="Inter, sans-serif" font-size="12" font-weight="600" text-anchor="middle">Info Disclosure</text>
    <line x1="10" y1="42" x2="190" y2="42" stroke="#3b82f6" stroke-width="1" opacity="0.3"/>
    <text x="100" y="60" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Leak system prompts</text>
    <text x="100" y="75" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Extract training data</text>
    <text x="100" y="90" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• PII in responses</text>
  </g>
  <line x1="570" y1="240" x2="490" y2="230" stroke="#3b82f6" stroke-width="1" stroke-dasharray="4,2"/>
  
  <!-- D - Denial of Service -->
  <g transform="translate(30, 320)">
    <rect x="0" y="0" width="200" height="100" rx="8" fill="#1e293b" stroke="#a855f7" stroke-width="2"/>
    <circle cx="25" cy="25" r="18" fill="#a855f7" opacity="0.2"/>
    <text x="25" y="32" fill="#a855f7" font-family="Inter, sans-serif" font-size="16" font-weight="700" text-anchor="middle">D</text>
    <text x="115" y="28" fill="#a855f7" font-family="Inter, sans-serif" font-size="12" font-weight="600" text-anchor="middle">Denial of Service</text>
    <line x1="10" y1="42" x2="190" y2="42" stroke="#a855f7" stroke-width="1" opacity="0.3"/>
    <text x="100" y="60" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Context exhaustion</text>
    <text x="100" y="75" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Token bombing</text>
    <text x="100" y="90" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Resource starvation</text>
  </g>
  <line x1="230" y1="370" x2="310" y2="280" stroke="#a855f7" stroke-width="1" stroke-dasharray="4,2"/>
  
  <!-- E - Elevation of Privilege -->
  <g transform="translate(570, 320)">
    <rect x="0" y="0" width="200" height="100" rx="8" fill="#1e293b" stroke="#14b8a6" stroke-width="2"/>
    <circle cx="25" cy="25" r="18" fill="#14b8a6" opacity="0.2"/>
    <text x="25" y="32" fill="#14b8a6" font-family="Inter, sans-serif" font-size="16" font-weight="700" text-anchor="middle">E</text>
    <text x="115" y="28" fill="#14b8a6" font-family="Inter, sans-serif" font-size="12" font-weight="600" text-anchor="middle">Elevation of Privilege</text>
    <line x1="10" y1="42" x2="190" y2="42" stroke="#14b8a6" stroke-width="1" opacity="0.3"/>
    <text x="100" y="60" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Prompt injection</text>
    <text x="100" y="75" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Tool abuse</text>
    <text x="100" y="90" fill="#94a3b8" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">• Bypass guardrails</text>
  </g>
  <line x1="570" y1="370" x2="490" y2="280" stroke="#14b8a6" stroke-width="1" stroke-dasharray="4,2"/>
  
  <!-- Bottom Legend -->
  <g transform="translate(150, 450)">
    <rect x="0" y="0" width="500" height="40" rx="6" fill="#1e293b" stroke="#334155" stroke-width="1"/>
    <text x="250" y="17" fill="#f8fafc" font-family="Inter, sans-serif" font-size="10" font-weight="500" text-anchor="middle">STRIDE Framework for LLM Security Assessment</text>
    <text x="250" y="32" fill="#64748b" font-family="Inter, sans-serif" font-size="9" text-anchor="middle">Each category requires specific mitigations in your security architecture</text>
  </g>
</svg>
